# 配置简化说明

## 修改概述

根据用户需求，已简化插件配置流程，移除了弹窗配置功能，直接使用 `config.js` 文件中的配置。

## 主要修改

### 1. 移除弹窗配置功能
- **之前**：用户需要在插件弹窗中手动输入API Key和URL
- **现在**：直接使用 `config.js` 文件中的配置

### 2. 简化配置流程
- **之前**：安装插件 → 点击图标 → 输入配置 → 保存配置
- **现在**：编辑 `config.js` → 安装插件

### 3. 修改的文件

#### `content.js`
- 修改 `loadConfig()` 函数，直接读取 `config.js` 中的 `KIMI_CONFIG`
- 移除 Chrome 存储相关的配置读取逻辑
- 简化消息处理函数

#### `popup.html`
- 移除配置输入表单
- 改为显示配置状态检查
- 添加配置说明信息

#### `popup.js`
- 移除配置保存功能
- 改为配置状态检查功能
- 显示当前配置是否有效

#### `manifest.json`
- 在 content_scripts 中添加 `config.js`
- 移除 `storage` 权限（不再需要）

## 配置方式

### 1. 编辑配置文件
打开 `config.js` 文件，修改以下内容：

```javascript
const KIMI_CONFIG = {
  // Kimi API 基础URL
  API_BASE_URL: 'https://api.moonshot.cn/v1',
  
  // 您的 Kimi API Key
  API_KEY: 'sk-KMwxBZIbaT02zkmF2CQqBy6FhZKASxmqngShjBAt13Bhx1HE', // 替换为您的真实API Key
  
  // 模型名称
  MODEL: 'moonshot-v1-8k',
  
  // 请求超时时间（毫秒）
  TIMEOUT: 30000,
  
  // 最大重试次数
  MAX_RETRIES: 3
};
```

### 2. 安装插件
1. 在 Chrome 中加载插件
2. 插件会自动读取 `config.js` 中的配置

### 3. 验证配置
点击插件图标，查看配置状态：
- ✅ 配置正常，API功能可用
- ⚠️ 请先在config.js中配置API Key

## 优势

### 1. 简化操作
- 无需在弹窗中重复输入配置
- 配置一次，永久使用

### 2. 提高安全性
- 配置直接写在代码中，避免存储泄露
- 减少权限需求

### 3. 便于管理
- 配置集中在一个文件中
- 便于版本控制和备份

### 4. 减少依赖
- 不依赖 Chrome 存储 API
- 减少插件权限需求

## 注意事项

### 1. 配置文件安全
- 不要将包含真实API Key的 `config.js` 文件上传到公共仓库
- 建议使用环境变量或配置文件模板

### 2. 配置更新
- 修改 `config.js` 后需要重新加载插件
- 在 `chrome://extensions/` 页面点击"重新加载"按钮

### 3. 错误处理
- 如果 `config.js` 未正确加载，插件会使用默认配置
- 控制台会显示相应的警告信息

## 测试验证

### 1. 配置检查
1. 点击插件图标
2. 查看配置状态显示
3. 确认API功能是否可用

### 2. 功能测试
1. 选中文本
2. 测试解释、翻译、润色功能
3. 确认API调用正常

### 3. 错误处理
1. 故意设置错误的API Key
2. 测试错误提示是否正常
3. 确认降级处理是否有效

## 兼容性

- 保持与原有功能的完全兼容
- 不影响朗读功能（无需API Key）
- 支持所有原有特性

---

**修改版本**：v1.1.0  
**修改时间**：2024年1月  
**修改状态**：已完成配置简化
